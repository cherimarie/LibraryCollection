<h2>All Books</h2>
<% if current_user && (current_user.has_role? :admin) %>
  <%= link_to "New Book", new_book_path, class: "btn right" %>
<% end %>

<table class="index">
  <thead>
    <tr>
      <th>Title</th>
      <th>Genre</th>
      <th>Author(s)</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <% @books.each do |b| %>
    <tr>
      <td> <%= link_to b.title, book_path(b.id) %></td>
      <td> 
      <% if b.genre %> 
        <%= link_to b.genre.name, genre_path(b.genre) %> 
      <% end %> 
      </td>
      <td>
        <% b.authors.each do |a| %>
          <%= link_to a.name, author_path(a) %>
        <% end %>
      </td>
      <% if current_user && (current_user.has_role? :admin) %>
        <td>
        <%= link_to "Edit", edit_book_path(b) %> 
        <%= link_to "Delete", book_path(b), method: :delete, data: {confirm: "Are you sure you want to delete this book?"} %> 
        </td>
      <% end %>
    </tr>
    <% end %>
  </tbody>
</table>